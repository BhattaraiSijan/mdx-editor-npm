{"version":3,"file":"image-reference.js","sources":["../../../../../../../node_modules/mdast-util-to-markdown/lib/handle/image-reference.js"],"sourcesContent":["/**\n * @import {Info, State} from 'mdast-util-to-markdown'\n * @import {ImageReference, Parents} from 'mdast'\n */\n\nimageReference.peek = imageReferencePeek\n\n/**\n * @param {ImageReference} node\n * @param {Parents | undefined} _\n * @param {State} state\n * @param {Info} info\n * @returns {string}\n */\nexport function imageReference(node, _, state, info) {\n  const type = node.referenceType\n  const exit = state.enter('imageReference')\n  let subexit = state.enter('label')\n  const tracker = state.createTracker(info)\n  let value = tracker.move('![')\n  const alt = state.safe(node.alt, {\n    before: value,\n    after: ']',\n    ...tracker.current()\n  })\n  value += tracker.move(alt + '][')\n\n  subexit()\n  // Hide the fact that we’re in phrasing, because escapes don’t work.\n  const stack = state.stack\n  state.stack = []\n  subexit = state.enter('reference')\n  // Note: for proper tracking, we should reset the output positions when we end\n  // up making a `shortcut` reference, because then there is no brace output.\n  // Practically, in that case, there is no content, so it doesn’t matter that\n  // we’ve tracked one too many characters.\n  const reference = state.safe(state.associationId(node), {\n    before: value,\n    after: ']',\n    ...tracker.current()\n  })\n  subexit()\n  state.stack = stack\n  exit()\n\n  if (type === 'full' || !alt || alt !== reference) {\n    value += tracker.move(reference + ']')\n  } else if (type === 'shortcut') {\n    // Remove the unwanted `[`.\n    value = value.slice(0, -1)\n  } else {\n    value += tracker.move(']')\n  }\n\n  return value\n}\n\n/**\n * @returns {string}\n */\nfunction imageReferencePeek() {\n  return '!'\n}\n"],"names":["imageReference","imageReferencePeek","node","_","state","info","type","exit","subexit","tracker","value","alt","stack","reference"],"mappings":"AAKAA,EAAe,OAAOC;AASf,SAASD,EAAeE,GAAMC,GAAGC,GAAOC,GAAM;AACnD,QAAMC,IAAOJ,EAAK,eACZK,IAAOH,EAAM,MAAM,gBAAgB;AACzC,MAAII,IAAUJ,EAAM,MAAM,OAAO;AACjC,QAAMK,IAAUL,EAAM,cAAcC,CAAI;AACxC,MAAIK,IAAQD,EAAQ,KAAK,IAAI;AAC7B,QAAME,IAAMP,EAAM,KAAKF,EAAK,KAAK;AAAA,IAC/B,QAAQQ;AAAA,IACR,OAAO;AAAA,IACP,GAAGD,EAAQ,QAAO;AAAA,EACtB,CAAG;AACD,EAAAC,KAASD,EAAQ,KAAKE,IAAM,IAAI,GAEhCH,EAAO;AAEP,QAAMI,IAAQR,EAAM;AACpB,EAAAA,EAAM,QAAQ,CAAA,GACdI,IAAUJ,EAAM,MAAM,WAAW;AAKjC,QAAMS,IAAYT,EAAM,KAAKA,EAAM,cAAcF,CAAI,GAAG;AAAA,IACtD,QAAQQ;AAAA,IACR,OAAO;AAAA,IACP,GAAGD,EAAQ,QAAO;AAAA,EACtB,CAAG;AACD,SAAAD,EAAO,GACPJ,EAAM,QAAQQ,GACdL,EAAI,GAEAD,MAAS,UAAU,CAACK,KAAOA,MAAQE,IACrCH,KAASD,EAAQ,KAAKI,IAAY,GAAG,IAC5BP,MAAS,aAElBI,IAAQA,EAAM,MAAM,GAAG,EAAE,IAEzBA,KAASD,EAAQ,KAAK,GAAG,GAGpBC;AACT;AAKA,SAAST,IAAqB;AAC5B,SAAO;AACT;","x_google_ignoreList":[0]}